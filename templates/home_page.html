<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>个人主页</title>
    <link rel="stylesheet" href="../static/layui/css/layui.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <script src="../static/js/jquery-1.10.2.min.js"></script>
    <script src="../static/layui/layui.js" charset="utf-8"></script>
</head>
<body>
<!-- Navbar (sit on top) -->
<nav>
    <div class="w3-top" style="width: 100%">
        <div class="w3-bar w3-white w3-wide w3-padding w3-card">
            <b class="w3-bar-item w3-button">开心往前飞</b>
            <a href="#" class="w3-bar-item w3-button"> 首页</a>
            <a href="#" target="_blank" class="w3-bar-item w3-button">登录/注册</a>
            <a href="#" target="_blank" class="w3-bar-item w3-button">个人主页</a>
        </div>
    </div>
</nav>
<div class="layui-row" style="margin-top:70px">
    &nbsp;&nbsp;
</div>
<div class="layui-row layui-col-space30" >
    <div class="layui-col-md7 "
         style="border:1px dashed #000;margin-left:50px;margin-right:50px;color: #dddddd;height: 600px;">
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 5px;">
            <legend><font color="black">个人信息</font></legend>
        </fieldset>

        <div class="layui-tab">
            <ul class="layui-tab-title">
                <li class="layui-this">基本信息</li>
                <li>修改信息</li>
                <li>修改密码</li>
                <li>我的邀约</li>
                <li>我的优惠卷</li>
            </ul>
            <div class="layui-tab-content">
                <!--这是展示信息的界面 -->
                <div class="layui-tab-item layui-show">
                    <table class="layui-table" lay-skin="line">
                        <colgroup>
                            <col width="150">
                            <col width="150">
                            <col width="200">
                            <col>
                        </colgroup>

                        <tbody>
                        <tr>
                            <td align="right">用户名：</td>
                            <td>{{ data['name'] }}</td>
                            <td align="right">联系方式：</td>
                            <td>{{ data['phone'] }}</td>
                        </tr>
                        <tr>
                            <td align="right">年龄：</td>
                            <td>{{ data['age'] }}</td>
                            <td align="right">性别：</td>
                            <td>{{ data['sex'] }}</td>
                        </tr>
                        <tr>
                            <td align="right">所在位置：</td>

                            <td colspan="3">{{ data['adderss'] }}</td>
                        </tr>
                        <tr>
                            <td align="right">个人简介：</td>
                            <td colspan="3" rowspan="2">
                                <div class="layui-panel">
                                    <div style="padding: 50px;">{{ data['breif'] }}</div>
                                </div>
                            </td>

                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                        </tr>
                        </tbody>
                    </table>
                    <div class="layui-col-md5">
                            &nbsp;&nbsp;
                        </div>
                        <div class="layui-col-md4">
                            <button type="button" class="layui-btn layui-bg-gray">退出登录</button>
                        </div>
                        <div class="layui-col-md3">
                            &nbsp;
                        </div>
                </div>
                <!-- 这是修改信息的表单 -->
                <div class="layui-tab-item">
                    <form id="tijiao" method="post">
                        <table class="layui-table" lay-skin="line">
                            <colgroup>
                                <col width="150">
                                <col width="150">
                                <col width="200">
                                <col>
                            </colgroup>
                            <tbody>
                            <tr>
                                <td align="right">头像：</td>
                                <td>
                                    <input type="text" name="xiugai_touxiang" id="xiugai_touxiang"
                                           lay-verify="title" placeholder="请上传文件假的" class="layui-input"
                                           style="width: 200px">
                                </td>
                                <td align="right">联系方式：</td>
                                <td><input type="text" name="xiugai_lianxifangshi" id="xiugai_lianxifangshi"
                                           lay-verify="title" placeholder="请输入电话号码" class="layui-input"></td>
                            </tr>
                            <tr>
                                <td align="right">年龄：</td>
                                <td><input class="layui-input" placeholder="年龄"
                                           name="xiugai_age" id="xiugai_age"></td>
                                <td align="right">性别：</td>
                                <td><input class="layui-input" placeholder="性别"
                                           name="xiugai_sex" id="xiugai_sex"></td>
                            </tr>
                            <tr>
                                <td align="right">所在位置：</td>

                                <td colspan="3"><input class="layui-input" placeholder="所在位置"
                                                       name="xiugai_position" id="xiugai_position"></td>
                            </tr>
                            <tr>
                                <td align="right">个人简介：</td>
                                <td colspan="3" rowspan="2">
                                    <div class="layui-panel">
                                        <div style="padding: 50px;">
                                            <input class="layui-input" placeholder="简介"
                                                   name="xiugai_jianjie" id="xiugai_jianjie">
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>&nbsp;</td>
                            </tr>
                            </tbody>
                        </table>
                        <div class="layui-col-md3">
                            &nbsp;&nbsp;
                        </div>
                        <div class="layui-col-md4">
                            <button type="button" class="layui-btn layui-bg-gray" name="xiugai_quxiao"
                                    id="xiugai_quxiao">取消修改
                            </button>
                        </div>
                        <div class="layui-col-md4">
                            <button type="button" class="layui-btn" name="xiugai_queren" id="xiugai_queren">确认修改
                            </button>
                        </div>
                    </form>
                </div>
                <!-- 这是修改密码的表单 -->
                <div class="layui-tab-item">
                    <table class="layui-table" lay-skin="line">
                        <colgroup>
                            <col width="150">
                            <col width="150">
                            <col width="200">
                        </colgroup>
                        <tbody>
                        <tr>
                            <td align="right">旧密码：</td>
                            <td>
                                <input type="password" lay-verify="title" id="jiumima"
                                       placeholder="必填" class="layui-input" style="width: 200px">
                            </td>
                        </tr>
                        <tr>
                            <td align="right">新密码：</td>
                            <td>
                                <input type="password" lay-verify="title" id="xinmima"
                                       placeholder="必填" class="layui-input" style="width: 200px">
                            </td>
                        </tr>
                        <tr>
                            <td align="right">确认新密码：</td>
                            <td>
                                <input type="password" lay-verify="title" id="querenxinmima"
                                       placeholder="必填" class="layui-input" style="width: 200px">
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <div class="layui-col-md2">
                        &nbsp;
                    </div>
                    <div class="layui-col-md4">
                        <button type="button" class="layui-btn layui-bg-gray" id="mima_quxiao">取消修改</button>
                    </div>
                    <div class="layui-col-md4">
                        <button type="button" class="layui-btn" value="submit" id="mima_queren">确认修改</button>
                    </div>
                </div>
                <!-- 这是邀约的信息 -->
                <div class="layui-tab-item">
                    <ul class="layui-timeline">
                        <li class="layui-timeline-item">
                            <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
                            <div class="layui-timeline-content layui-text">
                                <h3 class="layui-timeline-title">{{ yaoyue['yytime'] }}</h3>
                                <p>电影:<em>{{ yaoyue['movie'] }}</em></p>
                                <ul>
                                    <li>受邀者:{{ yaoyue['syz'] }}</li>
                                </ul>
                            </div>
                        </li>
                        <li class="layui-timeline-item">
                            <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
                            <div class="layui-timeline-content layui-text">
                                <h3 class="layui-timeline-title">{{ yaoyue['yytime'] }}</h3>
                                <p>电影:<em>{{ yaoyue['movie'] }}</em></p>
                                <ul>
                                    <li>受邀者:{{ yaoyue['syz'] }}</li>
                                </ul>
                            </div>
                        </li>
                        <li class="layui-timeline-item">
                            <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
                            <div class="layui-timeline-content layui-text">
                                <h3 class="layui-timeline-title">{{ yaoyue['yytime'] }}</h3>
                                <p>电影:<em>{{ yaoyue['movie'] }}</em></p>
                                <ul>
                                    <li>受邀者:{{ yaoyue['syz'] }}</li>
                                </ul>
                            </div>
                        </li>
                    </ul>

                </div>
                <!-- 这是优惠卷的信息-->
                <div class="layui-tab-item">
                    <table class="layui-table">
                        <colgroup>
                            <col width="150">
                            <col width="200">
                            <col>
                        </colgroup>
                        <thead>
                        <tr>
                            <th>优惠卷名称</th>
                            <th>开始日期</th>
                            <th>截止日期</th>
                            <th>优惠金额</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td style="width: 100px">一等卷</td>
                            <td style="width: 180px">2016-11-29</td>
                            <td style="width: 180px">2016-11-29</td>
                            <td>50/200</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-col-md4" style="border:1px dashed #000;margin-right:10px;height: 600px" id="haoyou" >
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 5px;">
            <legend>我的好友</legend>
        </fieldset>
        <ul class="flow-default">
            {% for k in friend.keys() %}
                <li>
                    <div class="layui-row">
                        <div class="layui-col-md3">
                        {{ friend[k][0] }}
                        </div>
                        <div class="layui-col-md3">
                        {{ friend[k][1] }}
                        </div>
                        <div class="layui-col-md3">
                        <button type="submit" class="layui-btn" id="{{ friend[k][0] }}">发起聊天</button>
                        </div>
                        <div class="layui-col-md3">
                        <button type="submit" class="layui-btn" id="{{ friend[k][0] }}">删除好友</button>
                        </div>
                        <hr class="layui-border-black">
                    </div>
                </li>
            {% endfor %}
        </ul>
    </div>
</div>

</body>
<!-- 修改信息的方法 -->
<script type="text/javascript">
    $(document).ready(function () {
        $('#xiugai_queren').on('click', function () {
            let touxiang = $('#xiugai_touxiang').val();
            let phone = $('#xiugai_lianxifangshi').val();
            let age = $('#xiugai_age').val();
            let sex = $('#xiugai_sex').val();
            let address = $('#xiugai_position').val();
            let brief = $('#xiugai_jianjie').val();
            $.ajax({
                type: "POST",
                dataType: "json",
                url: '/xiugaixinxi',
                data: {
                    'head_portrait': touxiang,
                    'gender': sex,
                    'age': age,
                    'self_introduction': brief,
                    'current_address': address,
                    'phone_number': phone
                },
                success: function (result) {
                    alert(result);
                    $(location).attr("href", "gerenzhongxin")
                }
            })
        })
        $('#xiugai_quxiao').on('click', function () {
            $('#xiugai_touxiang').val("");
            $('#xiugai_lianxifangshi').val("");
            $('#xiugai_age').val("");
            $('#xiugai_sex').val("");
            $('#xiugai_position').val("");
            $('#xiugai_jianjie').val("");
        })
    })
</script>
<!-- 修改密码的方法 -->
<script type="text/javascript">
    $(document).ready(function () {
        $('#mima_queren').on('click', function () {
            let old = $('#jiumima').val();
            let new_m = $('#xinmima').val();
            let new_m2 = $('#querenxinmima').val();
            {#这个地方差一个验证原密码是不是对的过程#}
            if (new_m !== new_m2)
                alert("两次密码不一致！")
            else if (old != {{ data['password'] }})
                alert("原密码不正确！");
            else
                $.ajax({
                    type: "POST",
                    url: '/xiugaimima',
                    data: {
                        'oldmima': old,
                        'xinmima': new_m
                    },
                    success: function () {
                        alert("修改成功");
                        $(location).attr("href", "gerenzhongxin")
                    }
                })
        })
        $('#mima_quxiao').on('click', function () {
            $('#jiumima').val('');
            $('#xinmima').val('');
            $('#querenxinmima').val('');
        })
    })
</script>
<!-- 邀约的方法（没写）-->
<script type="text/javascript">

</script>
<!-- 优惠卷的方法（没写）-->
<script type="text/javascript">

</script>
<!-- 好友的方法（没写） -->
<script type="text/javascript">
    $(document).ready(function (){

    })
</script>

</html>